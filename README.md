# Malware-Analysis-w-REMnux

# Objective

The objective of this lab was to analyze a malicious Microsoft Word document in order to extract relevant information such as the type of exploit it employs, the CVE code associated with the exploit, the name of the malicious software it downloads, the IP address and port it communicates with, and the name of the dropped executable file. 

# Skills Learned

- Malicious document analysis.
- Identifying exploits and associated CVE codes.
- Ability to generate and recognize attack signatures and patterns.
- Determining communication channels and malware payloads.
- Utilizing various analysis tools such as REMnux, rtfdump.py, rtfobj, shell code analyzer, and Gary Kessler's signatures
- Development of critical thinking and problem-solving skills in cybersecurity.

# Tools Used

- REMnux (Linux distribution for malware analysis).
- rtfdump.py (RTF file analyzer).
- rtfobj (RTF object extractor).
- scdbg (Shell code analyzer)
- Gary Kessler's signatures (for signature-based analysis)
- Virustotal

# Steps Taken
## Initial Analysis:
Obtained a suspicious Microsoft Word document.
Navigate to Letsdefend.io
Under Learn, Search Malicious Doc
![Malicious Doc](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/4a3b6644-c37c-4245-a675-8577e9e15c39)

Download REMnux from official site
![Download REMnux_1](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/3ab2e3cf-0f4a-4771-ad72-b60e6a776a79)
Fire up REMnux for malware analysis.

## RTF Analysis:
Unzip factura.doc using "unzip factura.doc"
Perform file command on factura file to see what type of file it is
![What type of file is doc](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/92a77216-7b57-438a-878f-cec816b599f1)

Used exiftool factura.doc to look at some time stamps
![exiftool(view stamps)](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/5a89adaa-570d-4be8-8a98-1ff32a115527)

Utilized rtfdump.py and rtfobj to extract and analyze RTF objects.
![rtfdump only](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/b8796171-6cf9-4099-9cf4-dfe3aa27f43b)
![rtfobj only](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/53e3e91b-b7ff-462f-bbb5-2b1d6e6d367b)

Identified shell code and suspicious patterns using shell code analyzer.
![scdbg(shell analyzer)](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/7c363093-0315-46c9-9a42-1044501bf1e7)

Utilized ChatGPT to do research i.e (Understanding GetProcAddress)
![CHATGPT](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/68077d8a-c688-4e07-91a3-75782f332028)


## CVE Identification:
Cross-referenced identified exploit patterns with known CVEs.
Found a match with CVE-2017-11882.

## Malware Download Analysis:
Tracked network activity to identify the IP address and port the document communicated with.
Cross-referenced the IP address with VirusTotal for additional confirmation and context regarding its reputation and associated threats.
Confirmed the IP address as 185.36.74.48 through VirusTotal, which provided insights into its malicious activities and connections to known malware campaigns.
Determined the downloaded file name as jan2.exe, corroborating findings from VirusTotal's analysis.
![Virustotal scan of seed-bc on http](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/74bf0b42-defa-4315-a26d-db7d5aa623a3)

## Dropped Executable Analysis:
Observed the behavior of the malware with SquareX using a disposable text viewer and noted the dropped executable as aro.exe.
![squarex](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/6638138c-52f0-4ef3-a8ac-dfa489a8fd77)


## Validation:
Verified findings using Gary Kessler's signatures for additional confirmation and utilized ChatGPT to research unknown information
![Gary Kessler file signatures](https://github.com/Fynnesse/Malware-Analysis-w-REMnux/assets/164644509/65dca14a-7bef-46f3-ad2e-98126eac2bed)


## Conclusion:
Through the analysis of the malicious Microsoft Word document, various aspects of the attack were uncovered. The exploit used was identified as CVE-2017-11882, leading to the download of jan2.exe from IP address 185.36.74.48 on port 80. The dropped executable after successful execution was determined to be aro.exe. This exercise enhanced skills in malware analysis, exploit identification, and the utilization of various analysis tools and techniques.
